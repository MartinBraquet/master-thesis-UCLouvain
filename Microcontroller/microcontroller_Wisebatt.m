close all;

% A = [
% 0	0.0006
% 3600	21.5
% 3620	0.0006
% 7220	21.5
% 7240	0.0006
% 10840	21.5
% 10860	0.0006
% 14460	36
% 14461	21.5
% 14481	0.0006
% 18081	21.5
% 18101	0.0006
% 21701	21.5
% 21721	0.0006
% 25321	21.5
% 25341	0.0006
% 28941	21.5
% 28961	0.0006
% 32561	21.5
% 32581	0.0006
% 36181	36
% 36182	21.5
% 36202	0.0006
% 39802	21.5
% 39822	0.0006
% 43422	21.5
% 43442	0.0006
% 47042	21.5
% 47062	0.0006
% 50662	21.5
% 50682	0.0006
% 54282	36
% 54283	21.5
% 54303	0.0006
% 57903	21.5
% 57923	0.0006
% 61523	21.5
% 61543	0.0006
% 65143	21.5
% 65163	0.0006
% 68763	21.5
% 68783	0.0006
% 72383	21.5
% 72403	0.0006
% 76003	36
% 76004	21.5
% 76024	0.0006
% 79624	21.5
% 79644	0.0006
% 83244	21.5
% 83264	0.0006
% 86864	21.5
% 86884	0.0006
% 90484	21.5
% 90504	2.739285714
% 90534	21.5
% 90554	2.739285714
% 90556	21.5
% 90576	2.739285714
% 90578	21.5
% 90598	2.739285714
% 90600	21.5
% 90620	2.739285714
% 90622	21.5
% 90642	2.739285714
% 90644	21.5
% 90664	2.739285714
% 90666	21.5
% 90686	2.739285714
% 90688	21.5
% 90708	2.739285714
% 90710	21.5
% 90730	2.739285714
% 90732	21.5
% 90752	2.739285714
% 90754	21.5
% 90774	2.739285714];

A = [0 0
100	2.742253856
150	0.003548066103
250	2.742279451
300	0.003573661302
400	2.742304643
450	0.003598853417
550	2.742329443
600	0.003623652797
700	2.742353859
750	0.003648069454
850	2.742377903
900	0.003672113064
1000	2.742401583
1050	0.00369579297
1150	2.742424909
1200	0.003719118175
1300	2.742447888
1350	0.003742097352
1450	2.742470529
1500	0.003764738835
1600	2.742492841
1650	0.003787050622
1750	2.742514831
1800	0.003809040376
1900	2.742536506
1950	0.003830715424
2050	2.742557874
2100	0.003852082758
2200	2.74257894
2250	0.003873149033
2350	2.742599712
2400	0.003893920567
2500	2.742620195];


t1 = A(:,1);
I1 = A(:,2);

t = zeros(2*size(t1,1)-1,1);
t(1:2:end) = t1;
t(2:2:end) = t1(2:end)-0.001;

t = t/1000;

I = zeros(size(t));
I(1:2:end) = I1;
I(2:2:end) = I1(1:end-1);

F = griddedInterpolant(t,I);
fun = @(x) F(x);
I_mean = integral(fun, t(1), t(end)) / t1(end)

figure;
plot(t,I, 'LineWidth', 2);
grid;
xlabel('Time [s]');
ylabel('CMWX1ZZABZ current [mA]');
%title('Wisebatt simulation');
matlab2tikz('wisebatt1.tex');

